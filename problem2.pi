include "mapreduce.pi"

def map (lineNumber lineText) =
  let chars = length lineText in
  let words = countWords lineText in
  (cons ["Characters" chars]
    (cons ["Words" words]
      (cons ["WordsPerLine" words] nil)))

def compare (key1 key2) = (<= key1 key2)

def reduce (key values) =
  let total = sum values in
  (cons [key total] nil)

val result = mapReduce map compare reduce input
print result